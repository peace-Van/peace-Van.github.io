---
layout: post
title: A neural network approach for climate classification - Sec 7. The 533-5.2 scheme
author: Van
category: climate
---

[Last section](https://peace-van.github.io/climate/2023/11/17/sec6.html) described the 533 SOM-crystal clustering methodology to obtain this scheme. In this section we will make a light walkthrough of the climate classification scheme. We will go direct because we have go through a similar illustration in [Sec 4](https://peace-van.github.io/climate/2023/11/14/sec4.html). Before that we have a little bit postprocessing to do.

## Merging subtypes

By crystal clustering we get clusters of the subtypes. We don't directly re-label the land pixels of the clustered subtypes; instead we find the new cluster centroids by a weighted average of the subtypes' centroids. Say there's a cluster of subtypes whose centroids are $\mathbf{c}_1, \mathbf{c}_2, ..., \mathbf{c}_m$ (each is a 15-dimensional vector), and their land proportions as weights are $w_1, w_2, ..., w_m$, then we have the new cluster centroid as

$$\mathbf{C} = \sum_{i=1}^m w_i \mathbf{c}_i / \sum_{i=1}^m w_i $$

In this way we get 26 new cluster centroids by crystal clustering at $T=5.2$. For each land pixel, assign the type with its nearest neighbor among the new cluster centroids.   

## The 533-5.2 scheme

![clust](/assets/NN6/5.2.png)   
Clusters obtained by crystal clustering at $T=5.2$ and the naming. Right-click for full image.   

![graph](/assets/NN7/graph_.png)
The MST of the new cluster centroids. The graph is plotted such that the edge lengths reflect the distances between cluster centroids. The graph shows that the methodology retains the intrinsic structure of climate data well. Right-click for full image.    

![globe](/assets/NN7/globe.png)
![legend](/assets/NN7/legend.png)
The 533-5.2 scheme, 1991-2020 climate normals. Right-click for full image.

|                             | **A** tropical | **C** subtropical | **D** continental | **E** temperate | **F** subarctic | **Gh**/**Gk** arctic |
|-----------------------------|----------------|-------------------|-------------------|-----------------|-----------------|----------------------|
| **f humid/oceanic**        | **Af**         | **Cf**            | /                 | **Efh**/**Efk** | **Ff**          | /                    |
| **m moderate/semi-oceanic** | **Am**         | **Cm**            | /                 | **Emh**/**Emk** | **Fm**          | /                    |
| **s seasonal**              | **As**         | **Cs**            | **Ds**            | **Es**          | **Fsh**/**Fsk** | /                    |
| **W arid**                  | **AW**         | **CW**            | **DW**            | **EW**          | /               | /                    |
| **S semi-arid**             | /              | /                 | **DSh**/**DSk**   | /               | /               | /                    |
| **H highland**              | /              | /                 | **DH**            | **EH**          | /               | /                    | 

> h/k denotes a warmer/cooler subtype.

The main group, as in the `322` scheme, is largely decided by winter temperature. Subtypes have more details to be specified per group.    

> All the judging rules mentioned below are manually induced and estimated for a better understanding; none of them is accurate. The machine learning model is complex and only the model itself can decide the climate type of a place based on computation.   

### The tropical group

This group is largely warm year round (sometimes hot). As we analyzed in [Sec 3](https://peace-van.github.io/climate/2023/11/12/sec3.html), thermal level and aridity are intrinsically correlated. According to what is learned by the model, **aridity compensates for a lower temperature**. If a place in this group has a cool winter, it must be dry, like Yunnan, China. The *tropical* title here may be well understood as *warm or dry winter*, corresponding to **a low value of the damp-coldness** feature. In general, the coldest month averages above 8°C. It's far lower than Köp­pen's 18°C threshold, with delicate considerations regarding aridity.    

> It's natural to have cool winter in deserts due to high continentality and dryness. With such considerations, the standalone arid group like Köp­pen's `B` group can be removed and merged into thermal zones, producing a more structured scheme.    

The four types in the group follow a decrease of precipitation. Generally, **Af** has no dry season, **Am** has a 3-month dry season, **As**'s is around 6 months, and **AW** is dry all year round. The type in this thermal zone with about 9 dry months is coded **Cs** for the integrity of group structure, but the better code may be **AS** in terms of climatic characteristics.   

> There are places classified in this tropical group which experience much cooler winter even below the mentioned 8°C threshold, e.g. the Sichuan basin in China. There are several factors accounting for this. First, the land cover scheme we use does not clearly distinguish between tropical and subtropical zones. The `Evergreen broadleaf forest` land cover type can respond to both tropical and subtropical forests, or even some temperate areas. Second, compared with the Yangtze River Plain, Sichuan basin has a pronounced warmer and less rainy winter. According to **centroid-based cluster analysis**, this characteristic locates the area closer to **Am**'s centroid rather than **Cf**'s. This clustering is based on comparison with cluster centroids rather than Köp­pen's decision-tree like thresholding. The classification is reasonable considering these factors.     

![Af](/assets/NN7/Af__.png)
**Af** humid tropical (rainforest) climate, land coverage 6.43%. This type has the lowest continentality over all types.    

![Am](/assets/NN7/Am__.png)
**Am** moderate tropical climate, land coverage 5.96%. It's among the types with highest seasonality due to pronounced dry-wet season pattern and very good growing conditions in the long rainy season.  

![As](/assets/NN7/As__.png)
**As** tropical dry-wet season (savanna) climate, land coverage 9.88%. It's among the types with highest seasonality due to pronounced dry-wet season pattern.    

![AW](/assets/NN7/AW__.png)
**AW** extreme arid and hot (hot desert) climate, land coverage 6.51%. This type has the lowest damp-coldness over all types. The seasonality is also very low due to the constantly dry condition.  

### The subtropical group

This group has a cool winter compared with the tropical group. The coldest month averages around 3-12°C in general; within the group, lower temperature usually goes with less precipitation in winter. Summer temperature is usually comparable to the typical tropics (above 25°C).      

The structure is largely similar to the tropical group, with the exception of the **Cs** type, as explained above. Another notable type is **Cm**, which, more often than not, experiences mild aridity through the year rather than a more pronounced dry-wet season pattern as in **Am**.    

![Cf](/assets/NN7/Cf__.png)
**Cf** humid subtropical climate, land coverage 2.42%. Largely equivalent to Köp­pen's `Cfa`.    

![Cm](/assets/NN7/Cm__.png)
**Cm** moderate subtropical climate, land coverage 3.00%. Much of the subtropical Mediterranean area (Köp­pen's `Csa`) falls into this type.    

![Cs](/assets/NN7/Cs__.png)
**Cs** warm semi-arid (hot steppe) climate, land coverage 4.84%. It covers the core area of the *Am* type in the `322` scheme. Though not truly subtropical, it does feature one 3-month wet season.

![CW](/assets/NN7/CW__.png)
**CW** arid subtropical (subtropical desert) climate, land coverage 3.49%. This type dominates the deserts in the Southern Hemisphere, featured by milder temperatures and slight precipitation. In the Northern Hemisphere the strong continentality makes the types of **EW** and **DW**.    

### The continental group

This group is more true of *continental* compared with Köp­pen's `D` group, distinguished from the temperate but less continental zone, thanks to the continentality climate feature learned by the model. Dryness and large annual temperature variance dominate the vast mid-latitude interior continent. There are no **f** or **m** types in this group. Winter is usually colder (coldest month averaging below -5°C) than the **E** group, but the code **D** is adopted to follow Köp­pen's convention.    

![Ds](/assets/NN7/Ds__.png)
**Ds** continental monsoonal climate, land coverage 3.35%. It's among the types with highest seasonality. The cold and dry winter combining the warm and wet summer makes the growing conditions swinging greatly in a year. Covers the core area of Köp­pen's `Dwa/Dwb`.     

![DSh](/assets/NN7/DSh__.png)
**DSh** semi-arid warm continental (cool steppe) climate, land coverage 3.26%. The condition is dryer/worse comparing with **Ds** due to warmer temperature or a less summer-concentrated precipitation pattern. Covers the core area of Köp­pen's `BSk`.    

![DSk](/assets/NN7/DSk__.png)
**DSk** semi-arid cool continental (cold steppe) climate, land coverage 2.25%. Very little precipitation spreads almost evenly through the year. Huge annual temperature range with very cold winters and warm to hot summers marks the high continentality. This type may be called the *Kazakhstan* climate due to its predominance there.    

![DW](/assets/NN7/DW__.png)
**DW** arid continental (continental desert) climate, land coverage 1.99%. Covers the core area of Köp­pen's `BWk`. This type has the highest continentality.     

![DH](/assets/NN7/DH__.png)
**DH** continental highland climate, land coverage 1.69%. Covers the core area of *Ds* in the `322` scheme. This type only occurs on the very high plateau over 3000m above sea level in the mid-latitude area, e.g. the Tibetan Plateau and the southern Andes, thus it may also be called the *Plateau* climate. The snowy windward slopes like the Alps and Caucasus are classified into oceanic types such as **Efk, Emk, Ff, Fm**.   

> Without a warm summer, the **DH** type sufficiently qualifies as subarctic, and is classified as such in other schemes like Köp­pen. Observing the mid-latitude continental location of the area, it appears more appropriate to name it as continental highland rather than highland subarctic. The location contributes to the high evaporation which is not observed in the typical high-latitude subarctic zone of similar thermal level. This is a unique feature of this climate type.     

### The temperate group

This group features an average temperature of -5-5°C for the coldest month, with the exception of **Emk**. Even though **Emk** experiences a much colder winter sometimes comparable to the continental group, the winter is with heavy precipitation from ocean airmass. Due to the maritime moderation and locations in higher latitudes, most areas enjoy a milder summer compared with the subtropical group, with the exception of **Es** and **EW**. **Es** sits in the transition zone between **Efh/Cm** and **DSh** and **EW** is a transitional type between **CW** and **DW**.   

![Efh](/assets/NN7/Efh__.png)
**Efh** warm oceanic (oceanic Mediterranean) climate, land coverage 0.68%. Largely equivalent to Köp­pen's `Csb`. This type has the highest seasonality over all types, featured by a distinct dry-summer wet-winter paradigm. 

![Efk](/assets/NN7/Efk__.png)
**Efk** cool oceanic climate, land coverage 1.37%. Covers the core area of Köp­pen's `Cfc`. With heavily moderated temperature and abundant precipitation all year round, this type has a similarly lowest continentality after **Af**. It's largely a cool version of **Af**.    

![Emh](/assets/NN7/Emh__.png)
**Emh** warm temperate climate, land coverage 3.40%. It can be seen as a transitional type between **Efk** and **Fsh**, which is the reason why the **m** subtype can be deemed as *semi-oceanic*. The mild continentality is expressed by the modest precipitation while the oceanic moderation of temperature is preserved. The type may also be called the *European* climate due to its predominance on the European continent.     

![Emk](/assets/NN7/Emk__.png)
**Emk** cool/cold temperate climate, land coverage 3.17%. On the west side of the Atlantic coast, the condition is drastically different, with long, cold and very snowy winters. As opposed to Europe, the oceanic characteristic is expressed by abundant precipitation through the year while the wintry coldness is inherited from continental climates. The type may also be called the *(East) Canadian* climate due to its predominance along Canada's most populated region - the Windsor-Quebec corridor. 

![Es](/assets/NN7/Es__.png)
**Es** temperate dry-wet season (continental Mediterranean) climate, land coverage 1.32%. The climate cannot be called temperate in most cases, just the winter thermal level falls into the temperate category. Most areas feature a hot and dry summer and a cool and rainy/snowy winter, except for the North China Plain. The counter-Mediterranean **Es** variant experiences a brief hot and rainy season in July and August, and mostly dry in other months of the year. This variant did not exist decades before and the local climate belonged to **DSh**; it emerged due to the warming winter in this region as shown in the case study in [Sec 5].

![EW](/assets/NN7/EW__.png)
**EW** arid temperate (semi-continental desert) climate, land coverage 1.58%. The climate is not truly temperate, just the winter thermal level falls into the temperate category. 

![EH](/assets/NN7/EH__.png)
**EH** temperate highland climate, land coverage 0.57%. This is a rare type occuring on low-latitude plateau like the northern Andes or continental low-elevation (1000-3000m) highlands like Lesotho and Qinba mountain range in China. Basically it's a summer-rain version of **Emh**.   

### The subarctic group

Like Köp­pen's definition for the subarctic types (the `c` subtype, at most 3 months averaging above 10°C), the condition in summer starts to play a role. Aside from a similar or colder winter of the continental group, temperature in the brief summer usually does not go over 12°C on average. The exception is **Fsh**, which may not be deemed subarctic in many cases. **Fsh** is basically a non summer-rain **Ds**, rendering worse growing conditions.

> Many regions, e.g. the southern tip of Greenland and majority of Iceland, fall into Köp­pen's arctic tundra type, but they are literally maritime moderated, not resembling the typical harsh arctic climate. Though both tundra, the climate conditions in Ushuaia, Argentina and Iqaluit, Canada are vastly different. Our scheme delineates them (some of these regions even fall into the temperate zone in our scheme).    

![Ff](/assets/NN7/Ff__.png)
**Ff** subarctic oceanic climate, land coverage 1.52%. Compared with **Efk**, the temperature steps down further and the precipitation is not as much (but still well above evaporation).   

![Fm](/assets/NN7/Fm__.png)
**Fm** moderate subarctic climate, land coverage 4.20%. A transitional type between **Emk** and **Gh**. Also transitional between **Ff** and **Fsk** on the continentality spectrum. This is the type with the highest damp-coldness.        

![Fsh](/assets/NN7/Fsh__.png)
**Fsh** humid continental climate, land coverage 10.89%. Compared with **Emk**, it shows a larger annual temperature range (colder winter and dryer summer) and less precipitation.   

![Fsk](/assets/NN7/Fsk__.png)
**Fsk** subarctic continental climate, land coverage 5.81%. It's **Fsh** transitioning towards **Gh** with continentality enhanced. This type has a similarly high damp-coldness with **Fm** due to the extreme coldness in winter.   

### The arctic group

Generally at most three months averaging above 0°C, this group is more true of arctic than Köp­pen's definition of no month averaging above 10°C. 

![Gh](/assets/NN7/Gh__.png)
**Gh** warm-summer arctic (tundra) climate, land coverage 6.97%. This is the type with a brief period above 0°C. 

![Gk](/assets/NN7/Gk__.png)
**Gk** cold arctic (icecap) climate, land coverage 3.49%. Generally no month averaging above 0°C. Aside from temperature, there should be at least some modest precipitation. The northern fringe of Greenland devoid of any precipitation is classified as **Gh** because icecap cannot form without water. This type is the one with lowest seasonality due to the constantly cold condition.

It can be seen many climate types of interesting distinct characteristics are derived, especially shown in the fine temperate zone **E**. But the scheme is more complicated and harder to grasp compared with the `322` scheme. Both schemes can have their use under different scenarios.   

> The reason we choose $T=5.2$ is that, on one hand, we feel no need for more climate types other than the above 26. On the other hand, if we set a lower $T=5.1$, **EH** will be merged with **DH**. We consider **EH** as a meaningful type so $T=5.1$ or below is not favored. The choice of $T$ is case-specific and depends on the target. Clustering quality metrics may also help to decide the optimal value of $T$.   

## Comparison with $k$-means clustering

![kmeans](/assets/NN7/kmeans26.png)
The *kmeans-26* scheme, 1991-2020 climate normals. 

Above shows the result of $k$-means clustering on the original climate features dataset. As was done in [Sec 4](https://peace-van.github.io/climate/2023/11/14/sec4.html), we set $k=26$ and the algorithm ran 200 iterations. The result is obviously poor, with Greenland and the Sahara Desert fractionated. It's because the $k$-means method favors a clustering with even-sized clusters and the two regions, despite their largely homogeneous climate conditions within, are large in size. Also, $k$-means does not retain any structural information among the clusters.   
